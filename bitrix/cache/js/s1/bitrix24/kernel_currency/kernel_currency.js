; /* /bitrix/js/currency/core_money_editor.min.js?15185961893073*/
; /* /bitrix/js/currency/core_currency.min.js?15185961891528*/

; /* Start:"a:4:{s:4:"full";s:55:"/bitrix/js/currency/core_currency.min.js?15185961891528";s:6:"source";s:36:"/bitrix/js/currency/core_currency.js";s:3:"min";s:40:"/bitrix/js/currency/core_currency.min.js";s:3:"map";s:40:"/bitrix/js/currency/core_currency.map.js";}"*/
(function(r){BX.namespace("BX.Currency");if(BX.Currency.defaultFormat){return}BX.mergeEx(BX.Currency,{currencyList:[],defaultFormat:{FORMAT_STRING:"#",DEC_POINT:".",THOUSANDS_SEP:" ",DECIMALS:2,HIDE_ZERO:"N"},setCurrencyFormat:function(r,e,t){var n=this.getCurrencyIndex(r),c=BX.clone(this.defaultFormat,true),i;t=!!t;if(n>-1&&!t){return}if(n===-1){n=this.currencyList.length}for(i in c){if(c.hasOwnProperty(i)&&typeof e[i]!=="undefined"){c[i]=e[i]}}this.currencyList[n]={currency:r,format:BX.clone(c,true)}},setCurrencies:function(r,e){var t;if(!!r&&BX.type.isArray(r)){for(t=0;t<r.length;t++){if(!!r[t].CURRENCY&&!!r[t].FORMAT){this.setCurrencyFormat(r[t].CURRENCY,r[t].FORMAT,e)}}}},getCurrencyFormat:function(r){var e=this.getCurrencyIndex(r);return e>-1?this.currencyList[e].format:false},getCurrencyIndex:function(r){var e,t=-1;if(this.currencyList.length===0){return t}for(e=0;e<this.currencyList.length;e++){if(this.currencyList[e].currency===r){t=e;break}}return t},clearCurrency:function(r){var e=this.getCurrencyIndex(r);if(e>-1)this.currencyList=BX.util.deleteFromArray(this.currencyList,e)},clean:function(){this.currencyList=[]},currencyFormat:function(r,e,t){var n="",c;t=!!t;c=this.getCurrencyFormat(e);if(!!c&&typeof c==="object"){c.CURRENT_DECIMALS=c.DECIMALS;if(c.HIDE_ZERO==="Y"&&r==parseInt(r,10))c.CURRENT_DECIMALS=0;n=BX.util.number_format(r,c.CURRENT_DECIMALS,c.DEC_POINT,c.THOUSANDS_SEP);if(t)n=c.FORMAT_STRING.replace(/(^|[^&])#/,"$1"+n)}return n}})})(window);
/* End */
;
; /* Start:"a:4:{s:4:"full";s:59:"/bitrix/js/currency/core_money_editor.min.js?15185961893073";s:6:"source";s:40:"/bitrix/js/currency/core_money_editor.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Currency");var t=null;function e(){if(t===null){t=BX.message("CURRENCY")}return t}BX.Currency.Editor=function(t){this.input=t.input;this.callback=t.callback;this.currency=t.currency;this.value=t.value||"";BX.ready(BX.delegate(this.init,this))};BX.Currency.Editor.prototype.init=function(){BX.bind(this.input,"bxchange",BX.proxy(this.valueEdit,this));BX.unbind(this.input,"change",BX.proxy(this.valueEdit,this))};BX.Currency.Editor.prototype.clean=function(){BX.unbind(this.input,"bxchange",BX.proxy(this.valueEdit,this));this.input=null};BX.Currency.Editor.prototype.valueEdit=function(){this.formatValue()};BX.Currency.Editor.prototype.setCurrency=function(t){this.value=BX.Currency.Editor.getUnFormattedValue(this.input.value,this.currency);this.currency=t;this.input.value=BX.Currency.Editor.getFormattedValue(this.value,this.currency);this.callValueChangeCallback()};BX.Currency.Editor.prototype.formatValue=function(){var t=BX.getCaretPosition(this.input);var e=this.input.value;this.changeValue();if(this.input.value.length>0){BX.setCaretPosition(this.input,t-e.length+this.input.value.length)}};BX.Currency.Editor.prototype.changeValue=function(){this.value=BX.Currency.Editor.getUnFormattedValue(this.input.value,this.currency);this.input.value=BX.Currency.Editor.getFormattedValue(this.value,this.currency);this.callValueChangeCallback()};BX.Currency.Editor.prototype.callValueChangeCallback=function(){if(!!this.callback){this.callback.apply(this,[this.value])}BX.onCustomEvent(this,"Currency::Editor::change",[this.value])};BX.Currency.Editor.getBaseCurrencyId=function(){var t=e();for(var r in t){if(!t.hasOwnProperty(r)){break}if(BX.prop.getString(t[r],"BASE","N")==="Y"){return r}}return""};BX.Currency.Editor.trimTrailingZeros=function(t,r){var i=e();if(typeof i[r]==="undefined"){return t}var n=BX.prop.getString(i[r],"DEC_POINT","");return n!==""?t.replace(new RegExp("\\"+n+"0+"),""):t};BX.Currency.Editor.getUnFormattedValue=function(t,r){var i=e();return t.replace(new RegExp("["+i[r]["SEPARATOR"]+"]","g"),"").replace(i[r]["DEC_POINT"],".")};BX.Currency.Editor.getFormattedValue=function(t,r){var i=t.length;var n="";var u=e();if(i>0){t=t.replace(/^0+/,"");if(t.length<=0){t="0"}else if(t.charAt(0)==="."){t="0"+t}i=t.length}var a;if(u[r]["SEPARATOR"]===","||u[r]["SEPARATOR"]==="."){a=new RegExp("[.,]")}else{a=new RegExp("["+u[r]["DEC_POINT"]+",.]")}var l=t.match(a);l=l===null?t.length:l.index;var c=0;for(var h=0;h<t.length;h++){var o=t.length-1-h;var s=t.charAt(o);var p="0123456789".indexOf(s)>=0;if(p){c++}if(o===l){c=0}if(o>=l){if(u[r]["DEC_POINT"]==="."&&s===","){s=u[r]["DEC_POINT"]}if(u[r]["DEC_POINT"]===","&&s==="."){s=u[r]["DEC_POINT"]}if(p||o===l&&s===u[r]["DEC_POINT"]){n=s+n}else if(i>o){i--}}else{if(p){n=s+n}else if(i>o){i--}if(p&&c%3===0&&c!==0&&o!==0){n=u[r]["SEPARATOR"]+n;if(i>=o){i++}}}}if(u[r]["DECIMALS"]>0){l=n.match(new RegExp("["+u[r]["DEC_POINT"]+"]"));l=l===null?n.length:l.index;while(n.length-1-l>u[r]["DECIMALS"]){if(i>=n.length-1){i--}n=n.substr(0,n.length-1)}}return n}})();
/* End */
;
//# sourceMappingURL=kernel_currency.map.js